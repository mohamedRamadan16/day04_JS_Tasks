<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>P02</title>
  </head>
  <body>
    <script>
      const users = [
        { id: 1, name: "Ali" },
        { id: 2, name: "Sara" },
      ];

      const posts = [
        { id: 1, userId: 1, title: "JS Basics" },
        { id: 2, userId: 1, title: "Async Await" },
        { id: 3, userId: 2, title: "HTML Tips" },
      ];

      // 1- Create an async function called showUserPost(userId, postId).
      // 2- Accept userId and postId as parameters.
      // Simulate an API delay using await and setTimeout.
      function delay(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms));
      }

      async function showUserPost(userId, postId) { // async returns a promise by default
        await delay(2000);

        // Search for the user with the given userId.
        // If the user does not exist, throw an error.
        const user = users.find((u) => u.id === userId);
        if (!user) {
          throw new Error("User not found");
        }

        // Search for the post with the given postId that belongs to the given user.
        // 3- If the post does not exist or does not belong to the user, throw an error.
        const post = posts.find((p) => p.id === postId && p.userId === userId);
        if (!post) {
          throw new Error("Post not found or does not belong to the user");
        }

        // If both user and post are found: Print the user name. Print the post title.
        console.log("User name:", user.name);
        console.log("Post title:", post.title);
      }

      showUserPost(1, 1)
        .then(() => {
          console.log("*************************************************");
          return showUserPost(1, 2);
        })
        .then(() => {
          console.log("*************************************************");
          return showUserPost(2, 3);
        })
        .then(() => {
          console.log("*************************************************");
          return showUserPost(1, 3);
        })
        .catch((err) => {
          console.log(err.message);
        });
    </script>
  </body>
</html>
